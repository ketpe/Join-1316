<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: classes/dueDateCheck.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: classes/dueDateCheck.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @description Class for validating and managing due date input for tasks.
 * Ensures the due date is in the correct format (DD/MM/YYYY) and not in the past.
 * Provides feedback to the user through UI components.
 * @class DueDateCheck
 * @namespace dueDateCheck
 * @property {string} dueDateValue - The due date value to validate.
 * @property {string} currentDueDate - The current due date value.
 * @property {Object} taskComponents - The task components for UI feedback.
 * @property {string} currentInputValue - The current input value in the due date field.
 * @property {string} dueDate - The validated due date.
 * @property {boolean} result - The result of the due date validation.
 */

class DueDateCheck {

    dueDate = "";
    result = false;

    /**
     * @description Creates an instance of the DueDateCheck class.
     * @memberof dueDateCheck
     * @param {string} dueDateValue - The due date value to validate.
     * @param {string} currentDueDate - The current due date value.
     * @param {Object} taskComponents - The task components for UI feedback.
     * @param {string} currentInputValue - The current input value in the due date field.
     */
    constructor(dueDateValue, currentDueDate, currentInputValue, taskComponents) {
        this.dueDateValue = dueDateValue;
        this.currentDueDate = currentDueDate;
        this.taskComponents = taskComponents;
        this.currentInputValue = currentInputValue;


    }

    /**
     * @description Checks the validity on input of the provided date value.
     * @function checkTheDateValueOnInput
     * @memberof dueDateCheck
     * @returns {boolean} True if the date is valid, false otherwise.
     */
    checkTheDateValueOnInput() {
        if(this.dueDateValue.length !== this.dueDateValue.replace(/\s/g, "").length){
            this.dueDateSetError("Spaces are not allowed");
            return [false, ""];
        }
        const dateCleanValue = (this.dueDateValue ?? "").trim();

        if (this.currentDueDate === dateCleanValue) {
            this.dueDate = this.currentDueDate;
            return [true, this.dueDate];
        }

        this.taskComponents.showAndLeaveErrorMessage("a-t-due-date-required", false);
        this.checkDateCharSet(dateCleanValue);

        return [true, this.dueDate];
    }

    /**
     * @description Checks the validity after input or lost focus of the provided date value.
     * @function checkTheDateAfterInput
     * @memberof dueDateCheck
     * @returns {boolean} True if the date is valid, false otherwise.
     */
    checkTheDateAfterInput(){
        const isDateOk = this.checkTheDateValue();
        //isDateOk ? this.dueDateSetOk() : this.dueDateSetError("Is not a valid date.");
        if(isDateOk){this.dueDateSetOk();}
        return isDateOk;
    }

    /**
     * @description Checks the validity after input or lost focus of the provided date value.
     * @function checkTheDateValue
     * @memberof dueDateCheck
     * @returns {boolean} True if the date is valid, false otherwise.
     */
    checkTheDateValue(){
        const dateCleanValue = (this.dueDateValue ?? "").trim();
        if (dateCleanValue.length &lt; 10) {
            this.dueDateSetError("Is not a valid date.");
            return false;
        }
        else if((dateCleanValue.length == 10 &amp;&amp; !this.checkIsCorrectDate(dateCleanValue)) || dateCleanValue.length > 10) {
            return false;
        }else{
            this.dueDateSetOk();
            this.dueDate = dateCleanValue;
            return true;
        }
    }


    /**
     * @description Check whether the date value conforms to the format. 
     * Split the string into its individual date components. 
     * Create a date from these numbers; this date cannot be in the past. 
     * Finally, the date components from the created date are compared with the components of the passed date. 
     * If they are equal, it returns true; otherwise, it returns false.
     * @function checkIsCorrectDate
     * @memberof dueDateCheck
     * @param {string} valueToCheck
     * @returns {boolean}
     */
    checkIsCorrectDate(valueToCheck) {
        const regexString = /^(\d{2})\/(\d{2})\/(\d{4})$/;
        const matchDateWithRegex = valueToCheck.match(regexString);
        if (!matchDateWithRegex) { 
            this.dueDateSetError("Not a valid date format");
            return false; 
        }

        const dateAsParts = this.getDatePartsOfDateValue(matchDateWithRegex);
        const valueDate = new Date(dateAsParts[2], dateAsParts[1], dateAsParts[0]);

        if (valueDate &lt; this.getDateNow) { 
            this.dueDateSetError("Date cannot be in the past");
            return false; 
        }

        return (this.isTheDateKorrect(valueDate, dateAsParts));

    }

    /**
     * @description Gets today's date with time set to 00:00:00.000.
     * @getter getDateNow
     * @memberof dueDateCheck
     * @returns {Date} Today's date.
     */
    get getDateNow(){
        const today = new Date();
        today.setHours(0, 0, 0, 0);
        return today;
    }

    /**
     * Checks if the provided date is correct.
     * @param {Date} valueDate 
     * @param {Array&lt;number>} dateAsParts 
     * @returns {boolean}
     */
    isTheDateKorrect(valueDate, dateAsParts){
        return (
            valueDate.getFullYear() === dateAsParts[2] &amp;&amp;
            valueDate.getMonth() === dateAsParts[1] &amp;&amp;
            valueDate.getDate() === dateAsParts[0]
        );
    }


    /**
     * @description Convert date components from regex array to integers.
     * @function getDatePartsOfDateValue
     * @memberof dueDateCheck
     * @param {RegExpMatchArray} matchDateWithRegex
     * @returns {number[]} day, month, year as numbers
     */
    getDatePartsOfDateValue(matchDateWithRegex) {
        const day = parseInt(matchDateWithRegex[1], 10);
        const month = parseInt(matchDateWithRegex[2], 10) - 1;
        const year = parseInt(matchDateWithRegex[3], 10);
        return [day, month, year];
    }

    /**
     * @description Check the character set of the date value string.
     * This function checks if the date value string contains only valid characters (digits and slashes).
     * @function checkDateCharSet
     * @memberof dueDateCheck
     * @param {string} dateValueString 
     * @returns {void}
     */
    checkDateCharSet(dateValueString) {
        if (this.currentInputValue.length >= dateValueString.length) { return; }
        const dateValueClean = dateValueString.replace(/\D/g, "");
        let constructedDate = "";

        for (let i = 0; i &lt; dateValueClean.length; i++){
            if (i == 2 || i == 4){
                constructedDate += `/${dateValueClean[i]}`;
            }else{
                constructedDate += `${dateValueClean[i]}`;
            }
        }

        this.setConstructedDateIntoTheField(constructedDate);
       
    }

    /**
     * @description Sets the constructed date into the display field and updates the dueDate property.
     * @function setConstructedDateIntoTheField
     * @memberof dueDateCheck
     * @param {string} cDate - The constructed date string to set.
     * @return {void}
     */
    setConstructedDateIntoTheField(cDate){
        document.getElementById('due-date-display').value = cDate;
        this.dueDate = cDate;
    }
    
    /**
     * @description Highlight the date field so the user can see that their entry was invalid.
     * The date is not correct. Display an error message and highlight the date field.
     * @function dueDateSetError
     * @memberof dueDateCheck
     * @param {string} errorMessage - The error message to display.
     * @return {void}
     */
    dueDateSetError(errorMessage = "") {
        this.taskComponents.showAndLeaveErrorMessage("a-t-due-date-required", true, errorMessage);
        this.taskComponents.showAndLeaveErrorBorder("due-date-display", true);
        this.result = false;
    }

    /**
     * @description The date is correct. Display the date field with normal formatting.
     * And clear any error messages.
     * @function dueDateSetOk
     * @memberof dueDateCheck
     * @return {void}
     */
    dueDateSetOk() {
        this.taskComponents.showAndLeaveErrorMessage("a-t-due-date-required", false);
        this.taskComponents.showAndLeaveErrorBorder("due-date-display", false);
        this.result = true;
    }

}</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-scripts_firebase.html">scripts/firebase</a></li></ul><h3>Namespaces</h3><ul><li><a href="addEditContacts.html">addEditContacts</a></li><li><a href="addTaskTemplate.html">addTaskTemplate</a></li><li><a href="app.html">app</a></li><li><a href="board.html">board</a></li><li><a href="boardDatabase.html">boardDatabase</a></li><li><a href="boardDetailView.html">boardDetailView</a></li><li><a href="boardSearch.html">boardSearch</a></li><li><a href="boardTaskTemplate.html">boardTaskTemplate</a></li><li><a href="boardTasks.html">boardTasks</a></li><li><a href="boardUtils.html">boardUtils</a></li><li><a href="contactTemplates.html">contactTemplates</a></li><li><a href="contacts.html">contacts</a></li><li><a href="dragAndDrop.html">dragAndDrop</a></li><li><a href="dueDateCheck_.html">dueDateCheck</a></li><li><a href="greeting.html">greeting</a></li><li><a href="help.html">help</a></li><li><a href="landscapeBlock.html">landscapeBlock</a></li><li><a href="login.html">login</a></li><li><a href="navigations.html">navigations</a></li><li><a href="openCloseDialog.html">openCloseDialog</a></li><li><a href="privacyLegal.html">privacyLegal</a></li><li><a href="script.html">script</a></li><li><a href="summary.html">summary</a></li><li><a href="taskComponents_.html">taskComponents</a></li></ul><h3>Classes</h3><ul><li><a href="AddTaskCache.html">AddTaskCache</a></li><li><a href="AddTaskMobileUtil.html">AddTaskMobileUtil</a></li><li><a href="AddTaskUtils.html">AddTaskUtils</a></li><li><a href="BoardTaskDetailDeleteUtil.html">BoardTaskDetailDeleteUtil</a></li><li><a href="BoardTaskDetailEditUtils.html">BoardTaskDetailEditUtils</a></li><li><a href="BoardTaskDetailViewUtils.html">BoardTaskDetailViewUtils</a></li><li><a href="Contact.html">Contact</a></li><li><a href="ContactAssigned.html">ContactAssigned</a></li><li><a href="CreateNewTask.html">CreateNewTask</a></li><li><a href="EditTaskSafeUtil.html">EditTaskSafeUtil</a></li><li><a href="FirebaseDatabase.html">FirebaseDatabase</a></li><li><a href="Subtask.html">Subtask</a></li><li><a href="SubtaskToTask.html">SubtaskToTask</a></li><li><a href="Task.html">Task</a></li><li><a href="TaskComponents.html">TaskComponents</a></li><li><a href="TaskElements.html">TaskElements</a></li><li><a href="dueDateCheck.DueDateCheck.html">DueDateCheck</a></li></ul><h3>Mixins</h3><ul><li><a href="taskComponents.categories.html">categories</a></li><li><a href="taskComponents.contacts.html">contacts</a></li><li><a href="taskComponents.create.html">create</a></li><li><a href="taskComponents.layout.html">layout</a></li><li><a href="taskComponents.priority.html">priority</a></li><li><a href="taskComponents.subtasks.html">subtasks</a></li><li><a href="taskComponents.validation.html">validation</a></li></ul><h3>Global</h3><ul><li><a href="global.html#firebaseConfig">firebaseConfig</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.4</a> on Thu Nov 13 2025 19:35:00 GMT+0100 (Mitteleurop√§ische Normalzeit)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
